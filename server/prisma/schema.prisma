generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Customer {
  id        String    @id @default(uuid())
  name      String
  accounts  Account[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@map("customers")
}

model DepositoType {
  id           String    @id @default(uuid())
  name         String    @unique
  yearlyReturn Decimal   @db.Decimal(5, 2)
  accounts     Account[]
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@map("deposito_types")
}

model Account {
  id         String   @id @default(uuid())
  customerId String
  customer   Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)

  depositoTypeId String
  depositoType   DepositoType @relation(fields: [depositoTypeId], references: [id])

  balance      Decimal       @default(0) @db.Decimal(15, 2)
  transactions Transaction[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  @@map("accounts")
}

enum TransactionType {
  DEPOSIT
  WITHDRAW
}

model Transaction {
  id        String  @id @default(uuid())
  accountId String
  account   Account @relation(fields: [accountId], references: [id], onDelete: Cascade)

  type            TransactionType
  amount          Decimal         @db.Decimal(15, 2)
  transactionDate DateTime        @db.Date
  balanceBefore   Decimal         @db.Decimal(15, 2)
  balanceAfter    Decimal         @db.Decimal(15, 2)
  interestEarned  Decimal         @default(0) @db.Decimal(15, 2)
  createdAt       DateTime        @default(now())

  @@map("transactions")
}
